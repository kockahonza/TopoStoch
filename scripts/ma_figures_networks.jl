using Revise
using NonEqDigits

using CairoMakie
using GLMakie
using JLD2
using Geppetto

includet("ma_colors.jl")
includet("ned_ca_s1_stats.jl")
includet("ma_graphviz.jl")

fig_kwargs = (;
    fontsize=8,
    figure_padding=0.0
)
fig_kwargs2 = (;
    fontsize=10,
    figure_padding=0.0
)
fig_kwargs3 = (;
    fig_kwargs2...,
    size=(single_col_width * 0.4, single_col_width * 0.4),
)
other_kwargs = (;
    node_size=4.0,
    edge_width=0.5,
    arrow_size=6.0,
)

function get_ac_coloring_extra_kwargs(g)
    acs = attracting_components(g)
    ac_classes = ac_eq_class.(Ref(g), acs)

    node_color = [MAColors.gray1() for _ in 1:nv(g)]
    for (ac, class) in zip(acs, ac_classes)
        for v in ac
            if class == :single
                node_color[v] = MAColors.ac_ss()
            elseif class == :eq
                node_color[v] = MAColors.ac_nss_eq()
            elseif class == :neq
                node_color[v] = MAColors.ac_nss_neq()
            end
        end
    end

    edge_color = [node_color[e.src] for e in edges(g)]

    (; e_color=false, node_color, edge_color)
end

################################################################################
# For figure 2 (numacs plus networks)
################################################################################
function f2_r124_v1(; kwargs...)
    # some saved/hardcoded positions to use
    pp1 = Point{2,Float32}[[3.0, 3.0], [1.3281027, 7.801583], [8.788723, 2.4386742], [1.8143778, 7.417807], [0.9566255, 3.6729279], [2.4552433, 6.4659653], [8.283378, 2.8011382], [2.4852808, 6.883159], [6.147224, 9.510905], [4.2407727, 7.2257137], [7.427527, 3.7925913], [3.9467535, 6.7221065], [1.5572437, 3.8586738], [2.966725, 6.0116615], [7.585234, 3.3046503], [3.342512, 6.3276653], [3.945704, 0.62469023], [4.041539, 2.5424602], [5.8668523, 2.7930262], [4.130808, 3.308027], [2.5206087, 3.803837], [3.6487694, 4.712955], [6.1536965, 3.302475], [4.117363, 4.3492246], [6.008791, 8.908372], [4.784686, 7.020344], [6.853893, 4.3067975], [4.564082, 6.3090115], [2.3925226, 4.11248], [3.5494123, 5.3562384], [6.720627, 3.76296], [4.106907, 5.4935226], [9.115075, 6.567199], [8.527446, 6.3390207], [7.7925787, 5.6941795], [7.7078905, 6.0132933], [5.0220795, 5.0884323], [5.7609415, 5.2533126], [7.173354, 5.5075984], [6.6926003, 5.6359873], [6.110993, 7.773186], [5.9986854, 7.1002054], [6.3149033, 5.6771326], [5.9652653, 6.226559], [4.395176, 4.7655463], [4.9200416, 5.722167], [6.4562545, 5.2027903], [5.813485, 5.4821115], [4.0718455, 1.2303998], [4.2473364, 2.066916], [5.312384, 2.9888923], [4.5840364, 2.9728065], [3.1116984, 4.0472164], [3.8456006, 4.2576814], [5.5302587, 3.6746464], [4.664177, 3.981581], [5.8204093, 8.069906], [5.503597, 7.097015], [6.179469, 5.098191], [5.4311023, 5.9643598], [3.4126747, 4.4565], [4.1496544, 4.882143], [5.9767957, 4.469583], [5.2476373, 4.422474]]

    ss = double_col_width / 2

    ma = MolAut(6, 124; reduced=false)
    faa = plotgm(ma;
        layout=pp1,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        figure=(;
            # size=(200, 200),
            size=(200, 200) .* 0.9 .- (0, 12),
            fig_kwargs...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    # faa.axis.title = "Rule 124"

    save("./data/figures/fig2/r124_final.pdf", faa.figure)

    faa
end

function f2_r142_v1(; kwargs...)
    # some saved/hardcoded positions to use
    pp1 = Point{2,Float32}[[0.9534411, -2.5038016], [0.59584093, -3.9095232], [0.17095925, -3.8032608], [0.40841606, -3.772475], [-0.2644334, -4.0696282], [-0.7896743, -1.178741], [-0.04176763, -3.8707201], [0.18871951, -3.6994324], [-0.12653562, -4.56081], [-0.56409085, -1.6818004], [-0.023905873, -1.8806934], [-0.30590898, -1.7867441], [-0.19838633, -4.3000517], [-0.73771966, -1.4791207], [-0.12667106, -4.0360994], [-0.031074021, -3.757724], [0.40003258, -4.6377816], [-0.17447847, -1.8818226], [0.23421696, -1.4959354], [0.041789383, -1.6775165], [0.16320035, -0.9260697], [0.8454891, -2.8582444], [0.20679337, -1.2218099], [0.14329359, -1.447856], [0.1569122, -4.5807614], [-0.41196775, -1.8441463], [0.16862643, -1.7290664], [-0.114933014, -1.7968268], [0.006272954, -4.4205093], [-0.6872183, -1.7501893], [-0.112264484, -4.234797], [-0.19575872, -3.9521077], [0.80941314, -4.3292994], [0.7402337, -4.0661936], [0.26649374, -1.1076274], [0.64595395, -3.8159833], [-0.29446185, -0.95322317], [-0.55860937, -0.9952068], [-0.022395432, -1.0221043], [0.45722497, -3.6276524], [-0.6913165, -1.2382712], [-0.62224627, -1.4582634], [0.6129771, -2.6541712], [-0.4807415, -1.6356587], [-0.48146188, -1.0970969], [-0.62066877, -1.2446408], [-0.25106055, -1.0372868], [0.18442686, -3.564314], [0.62031364, -4.46002], [0.76193213, -4.2402124], [0.3301616, -1.2924347], [0.8343458, -3.976295], [-0.07149768, -0.8757424], [-0.34913814, -0.80281013], [0.14763302, -1.0583472], [0.7379994, -3.706066], [0.43787953, -4.516986], [0.713044, -4.4440646], [0.38461092, -1.5529914], [0.9218695, -4.2380505], [0.24218431, -4.542032], [0.528085, -4.6229944], [-0.0060266694, -4.495908], [0.7375371, -2.3426912]]
    pp2 = Point{2,Float32}[[-0.18817669, -3.3056338], [0.59584093, -3.9095232], [0.17095925, -3.8032608], [0.40841606, -3.772475], [-0.2644334, -4.0696282], [-0.38967428, -2.278741], [-0.04176763, -3.8707201], [0.18871951, -3.6994324], [-0.12653562, -4.56081], [-0.16409084, -2.7818003], [0.37609413, -2.9806933], [0.09409102, -2.886744], [-0.19838633, -4.3000517], [-0.33771965, -2.5791206], [-0.12667106, -4.0360994], [-0.031074021, -3.757724], [0.40003258, -4.6377816], [0.22552153, -2.9818225], [0.6342169, -2.5959353], [0.44178942, -2.7775164], [0.56320035, -2.0260696], [-0.16117068, -3.6083946], [0.60679334, -2.3218098], [0.5432936, -2.5478559], [0.1569122, -4.5807614], [-0.011967756, -2.9441462], [0.5686264, -2.8290663], [0.285067, -2.8968267], [0.006272954, -4.4205093], [-0.2872183, -2.8501892], [-0.112264484, -4.234797], [-0.19575872, -3.9521077], [0.80941314, -4.3292994], [0.7402337, -4.0661936], [0.6664937, -2.2076273], [0.64595395, -3.8159833], [0.10553815, -2.0532231], [-0.15860936, -2.0952067], [0.37760457, -2.1221042], [0.45722497, -3.6276524], [-0.29131648, -2.3382711], [-0.22224626, -2.5582633], [-0.28607348, -3.5781186], [-0.0807415, -2.7356586], [-0.081461884, -2.1970968], [-0.22066876, -2.3446407], [0.14893946, -2.1372867], [0.18442686, -3.564314], [0.62031364, -4.46002], [0.76193213, -4.2402124], [0.73016155, -2.3924346], [0.8343458, -3.976295], [0.32850233, -1.9757423], [0.050861858, -1.9028101], [0.547633, -2.1583471], [0.7379994, -3.706066], [0.43787953, -4.516986], [0.713044, -4.4440646], [0.78461087, -2.6529913], [0.9218695, -4.2380505], [0.24218431, -4.542032], [0.528085, -4.6229944], [-0.0060266694, -4.495908], [-0.35021278, -3.2753577]]
    pp3 = Point{2,Float32}[[0.44135505, -3.3278747], [0.38039595, -3.8100932], [0.12385982, -3.7165284], [0.29657722, -3.6949365], [-0.18488416, -3.9756312], [-0.20887516, -2.377832], [-0.023457961, -3.7525148], [0.098460205, -3.507807], [-0.12653562, -4.56081], [-0.20125528, -2.802472], [0.20767856, -3.2055206], [-0.023457961, -2.9248261], [-0.19838633, -4.3000517], [-0.26475433, -2.6009479], [-0.092036925, -3.9900255], [-0.046317615, -3.5437934], [0.25085792, -4.608993], [0.10354012, -3.2199152], [0.35499632, -2.96801], [0.25085792, -3.0039964], [0.31435695, -2.6081452], [0.35245636, -3.3062828], [0.34991643, -2.7664857], [0.30927703, -2.845656], [0.10354012, -4.5945983], [-0.056477465, -3.1263504], [0.37531602, -3.111956], [0.13909958, -2.946418], [0.032421198, -4.342693], [-0.21395509, -2.9104316], [-0.064097345, -4.2347336], [-0.16996501, -3.6956186], [0.41341546, -4.1339717], [0.42611527, -3.9828284], [0.311817, -2.3346481], [0.48199442, -3.702134], [0.019721389, -2.1835048], [-0.13013636, -2.161913], [0.17465906, -2.406621], [0.30927703, -3.435834], [-0.084417045, -2.5361724], [-0.152996, -2.6369345], [-0.21649505, -3.435834], [-0.10473674, -2.7880776], [-0.031077845, -2.3634372], [-0.13267632, -2.4929886], [0.0654407, -2.35624], [0.088300355, -3.3278747], [0.39309576, -4.2779174], [0.47437453, -4.1267743], [0.40833554, -2.773683], [0.59121275, -3.8820662], [0.20767856, -2.1331239], [0.03750112, -2.0755455], [0.41341546, -2.5865533], [0.5226338, -3.5725825], [0.25085792, -4.3570876], [0.49977416, -4.4506526], [0.41595542, -2.9608126], [0.59121275, -4.2635226], [0.14671947, -4.4002714], [0.4032556, -4.5658092], [-0.0060266694, -4.495908], [-0.14791608, -3.3998475]]

    pp4 = [Point2f(p[2], p[1]) for p in pp2]

    ma = MolAut(6, 142; reduced=false)
    faa = plotgm(ma;
        layout=pp4,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        # figure=(; size=(600, 600)),
        figure=(;
            # size=(120, 240),
            # size=(260, 120),
            size=(250, 120) .* 0.9 .- (0, 12),
            fig_kwargs...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    # faa.axis.title = "Rule 142"

    save("./data/figures/fig2/r142_final.pdf", faa.figure)

    faa
end

function f2_r170_v1(; kwargs...)
    ma = MolAut(6, 170; reduced=false)

    pos = get_gv_layout_positions(ma;
        cluster=true
    )

    faa = plotgm(ma;
        layout=pos,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        # figure=(; size=(600, 600)),
        figure=(;
            # size=(250, 160),
            size=(250, 160) .* 0.9 .- (0, 12),
            fig_kwargs...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    # faa.axis.title = "Rule 170"

    save("./data/figures/fig2/r170_final.pdf", faa.figure)

    faa
end

function make_f2_plots()
    f2_r124_v1()
    f2_r142_v1()
    f2_r170_v1()
    nothing
end

################################################################################
# For figure 3 (N=5 vs 6)
################################################################################
function f3_r124_L5_v1(; kwargs...)
    # some saved/hardcoded positions to use
    pp1 = Point{2,Float32}[[-3.3158305, -2.3041008], [0.48989946, -2.9757426], [-2.9944577, 1.009332], [1.2341311, -2.0802202], [2.5027077, 0.33769017], [1.893791, 0.069033474], [-2.4870272, 0.0018692929], [1.4371034, -1.1399218], [-2.1149113, -3.0429068], [0.69287175, -1.8115635], [-1.5229088, -1.4757427], [0.55755687, -0.9608173], [1.7923049, 1.770526], [1.0311588, 0.47201854], [-1.8781103, -0.62499636], [1.0480732, -0.6026083], [-0.9478207, 3.1361976], [-1.201536, 2.3302274], [-2.0303395, 0.87500364], [-1.5229088, 1.748138], [0.134698, 2.5764961], [-0.017531201, 1.7257499], [-1.4214227, 0.56157076], [-0.9478207, 1.2108245], [-0.9647351, -2.3041008], [-0.27124652, -1.96828], [-0.8970777, -0.93842924], [-0.25433218, -1.207086], [1.0819019, 1.9720185], [0.8281866, 1.1884365], [-1.3368509, -0.37872773], [-0.02049901, 0.28700992]]
    pp2 = Point{2,Float32}[[2.4433439, 1.1796823], [2.359875, -2.052403], [-2.9821322, -0.9683495], [1.9842651, -1.6910518], [2.1372914, 2.8659875], [1.893791, 0.069033474], [-2.3143814, -0.74752384], [1.4371034, -1.1399218], [-1.3823123, -2.63458], [0.69287175, -1.8115635], [-1.5229088, -1.4757427], [0.55755687, -0.9608173], [1.399983, 2.7656124], [1.0311588, 0.47201854], [-1.8781103, -0.62499636], [1.0480732, -0.6026083], [-2.6204338, 2.364111], [-1.9944173, 2.2235856], [-2.0303395, 0.87500364], [-1.5229088, 1.748138], [0.134698, 2.5764961], [-0.017531201, 1.7257499], [-1.4214227, 0.56157076], [-0.9478207, 1.2108245], [-0.5337122, -2.4739792], [-0.27124652, -1.96828], [-0.8970777, -0.93842924], [-0.25433218, -1.207086], [1.0819019, 1.9720185], [0.8281866, 1.1884365], [-1.3368509, -0.37872773], [-0.02049901, 0.28700992]]

    ma = MolAut(5, 124; reduced=false)
    faa = plotgm(ma;
        layout=pp2,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        figure=(;
            fig_kwargs3...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    # faa.axis.title = L"N=5"

    save("./data/figures/fig3/r124_L5.pdf", faa.figure)

    faa
end

function f3_r124_L6_v1(; kwargs...)
    # some saved/hardcoded positions to use
    pp1 = Point{2,Float32}[[3.0, 3.0], [1.3281027, 7.801583], [8.788723, 2.4386742], [1.8143778, 7.417807], [0.9566255, 3.6729279], [2.4552433, 6.4659653], [8.283378, 2.8011382], [2.4852808, 6.883159], [6.147224, 9.510905], [4.2407727, 7.2257137], [7.427527, 3.7925913], [3.9467535, 6.7221065], [1.5572437, 3.8586738], [2.966725, 6.0116615], [7.585234, 3.3046503], [3.342512, 6.3276653], [3.945704, 0.62469023], [4.041539, 2.5424602], [5.8668523, 2.7930262], [4.130808, 3.308027], [2.5206087, 3.803837], [3.6487694, 4.712955], [6.1536965, 3.302475], [4.117363, 4.3492246], [6.008791, 8.908372], [4.784686, 7.020344], [6.853893, 4.3067975], [4.564082, 6.3090115], [2.3925226, 4.11248], [3.5494123, 5.3562384], [6.720627, 3.76296], [4.106907, 5.4935226], [9.115075, 6.567199], [8.527446, 6.3390207], [7.7925787, 5.6941795], [7.7078905, 6.0132933], [5.0220795, 5.0884323], [5.7609415, 5.2533126], [7.173354, 5.5075984], [6.6926003, 5.6359873], [6.110993, 7.773186], [5.9986854, 7.1002054], [6.3149033, 5.6771326], [5.9652653, 6.226559], [4.395176, 4.7655463], [4.9200416, 5.722167], [6.4562545, 5.2027903], [5.813485, 5.4821115], [4.0718455, 1.2303998], [4.2473364, 2.066916], [5.312384, 2.9888923], [4.5840364, 2.9728065], [3.1116984, 4.0472164], [3.8456006, 4.2576814], [5.5302587, 3.6746464], [4.664177, 3.981581], [5.8204093, 8.069906], [5.503597, 7.097015], [6.179469, 5.098191], [5.4311023, 5.9643598], [3.4126747, 4.4565], [4.1496544, 4.882143], [5.9767957, 4.469583], [5.2476373, 4.422474]]

    ma = MolAut(6, 124; reduced=false)
    faa = plotgm(ma;
        layout=pp1,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        figure=(;
            fig_kwargs3...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    # faa.axis.title = L"N=5"

    save("./data/figures/fig3/r124_L6.pdf", faa.figure)

    faa
end

function f3_r6_L5_v1(; kwargs...)
    # some saved/hardcoded positions to use
    pp1 = Point{2,Float32}[[1.8883634, 5.075595], [3.139958, 2.2920175], [3.9583256, 4.0828066], [3.5637395, 3.2076955], [2.8001711, 5.3689313], [2.2744198, 4.420327], [3.3367188, 4.7157497], [3.0719006, 4.012087], [1.2503068, 4.5985565], [1.1851717, 3.297496], [2.4581087, 3.5715945], [1.860187, 3.2408714], [2.0606937, 4.958986], [1.5738807, 3.9831305], [2.6198454, 4.423818], [2.2324698, 3.8632154], [1.3537402, 2.631873], [2.2245176, 2.3457294], [3.540733, 2.8488812], [2.9941707, 2.6873097], [2.9396162, 4.2932987], [2.5439646, 4.0262585], [3.4304833, 3.6292262], [3.0272646, 3.4317207], [1.2953582, 3.639436], [1.633722, 2.9461193], [2.892096, 3.0442362], [2.307842, 2.7846987], [2.0479004, 4.207148], [1.8760788, 3.6509037], [2.773829, 3.7599645], [2.407745, 3.3109055]]

    ma = MolAut(5, 6; reduced=false)
    faa = plotgm(ma;
        layout=pp1,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        figure=(;
            fig_kwargs3...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    # faa.axis.title = L"N=5"

    save("./data/figures/fig3/r6_L5.pdf", faa.figure)

    faa
end

function f3_r6_L6_v1(; kwargs...)
    # some saved/hardcoded positions to use
    pp1 = Point{2,Float32}[[-2.8263884, -2.1153064], [-0.7935086, -3.3829234], [-1.239787, -2.8330395], [-0.16281591, -2.7797716], [-2.7537432, -0.59743506], [1.6103098, -1.3954259], [-1.507348, -1.5192752], [0.278676, -1.7286814], [-3.574256, 1.6519394], [-0.034503162, -1.1674945], [-1.7139032, -0.24704012], [-0.69064784, -0.89613503], [-2.6404467, 0.8802756], [0.90907305, -0.9233005], [-1.4984536, 0.05101677], [-0.10406352, -0.6920112], [-3.40737, 0.8256888], [-1.1925435, -0.3001761], [-0.0052619902, 1.3813777], [-0.29781887, 0.5695565], [-0.22514832, 2.823039], [1.89335, 0.9772507], [0.32989657, 2.163845], [0.81191343, 1.2235934], [-2.7510593, 1.7011298], [-0.42207792, -0.44618002], [-0.9010934, 0.80054265], [-0.7204925, 0.004441544], [-1.5241609, 2.0482464], [0.7519015, 0.12172978], [-0.7106225, 1.4383079], [0.03401429, 0.5609622], [-2.3334553, -1.5794511], [-0.9971358, -2.1471233], [1.8365985, -0.65361434], [0.62750787, -1.6516328], [2.1348002, 1.4240693], [2.1418803, 0.055344783], [2.210091, 0.43975502], [1.5071465, -0.7670691], [-0.40178466, 1.236172], [0.06823407, -0.101122215], [1.4471624, -0.0019779368], [0.47218755, -0.6485702], [0.9733409, 1.5337751], [1.1616054, 0.22182949], [1.5656378, 0.85191333], [1.1142622, -0.27246606], [-2.4791613, -0.1306211], [-1.2002096, -0.77304167], [1.0850757, 0.5803835], [0.32989177, -0.34659392], [1.0980039, 2.2924194], [1.790983, 1.3219975], [1.4168384, 1.5265882], [1.4525247, 0.49977356], [-1.5784124, 1.1799902], [-0.6966761, 0.32936722], [0.3651625, 0.73620826], [0.03649168, 0.13691702], [-0.21647687, 1.9427058], [0.57922393, 1.0387149], [0.5813184, 1.5827191], [0.760972, 0.66334444]]

    ma = MolAut(6, 6; reduced=false)
    faa = plotgm(ma;
        layout=pp1,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        figure=(;
            fig_kwargs3...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    # faa.axis.title = L"N=5"

    save("./data/figures/fig3/r6_L6.pdf", faa.figure)

    faa
end

function make_f3_plots()
    f3_r124_L5_v1()
    f3_r124_L6_v1()
    f3_r6_L5_v1()
    f3_r6_L6_v1()
    nothing
end

# NOTE: OLD! Rule 73
function f3_L6_v1(; kwargs...)
    # some saved/hardcoded positions to use
    pp1 = Point{2,Float32}[[-2.6693203, -3.4231], [-2.0735102, -3.1046536], [-3.0871654, -4.3243346], [6.7428737, -4.7129087], [-1.9834849, -2.4812906], [-1.0770122, -3.0346308], [3.285865, -2.4519536], [-0.21354926, -3.5976274], [-3.6204207, -4.3842425], [-3.4106503, -3.411869], [-3.061753, -5.5215974], [6.950693, -5.6871343], [4.888482, -6.692787], [5.84765, -6.9442], [-2.410207, -6.4305816], [6.3751926, -6.629934], [-1.8655874, -2.7601376], [-0.7850729, -2.8473125], [-3.023382, -2.8023212], [6.34322, -3.9900959], [-0.81899154, -2.4479222], [0.059339553, -3.2414753], [2.850188, -2.1892915], [0.64910626, -4.11584], [1.3656595, -2.7846594], [1.5270213, -3.677711], [1.9949704, -2.1717806], [0.5091396, -5.6599627], [0.32032362, -2.613928], [0.8385285, -3.7687058], [2.479056, -2.1017375], [0.8457465, -4.821532], [-2.4747517, -4.0069036], [3.205184, -4.6583166], [-2.5632672, -4.9583087], [-1.8159255, -5.74972], [-2.0584538, -3.557701], [3.7699504, -4.0454383], [3.7860866, -2.8722134], [3.9133277, -3.3301365], [-2.8830585, -4.967183], [2.4467835, -4.5707626], [-2.2004366, -6.140321], [-1.0293434, -6.2586174], [4.0731893, -6.252814], [1.1107982, -6.3020716], [-1.1474597, -6.5981855], [0.018546134, -6.568549], [4.6966486, -3.9900959], [0.52167845, -3.0203853], [5.3041215, -3.8643894], [5.84765, -3.8643894], [4.0572033, -4.430069], [1.1470714, -3.9049838], [1.3684309, -5.917479], [1.4497988, -4.8714952], [-1.9681392, -5.253669], [1.9304258, -4.273079], [-1.0273483, -5.798665], [-0.1819684, -5.923752], [3.7534668, -5.372868], [1.2249862, -4.9863105], [0.0926579, -6.145562], [0.7708868, -5.6920714]]

    ss = double_col_width / 2

    ma = MolAut(6, 73; reduced=false)
    faa = plotgm(ma;
        layout=pp1,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        figure=(;
            # size=(200, 200),
            size=(single_col_width * 0.95, single_col_width * 0.4),
            fig_kwargs2...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    faa.axis.title = L"N=6"

    save("./data/figures/gv_sample_networks/r73_L6.pdf", faa.figure)

    faa
end

function f3_L5_v1(; kwargs...)
    # some saved/hardcoded positions to use
    pp1 = Point{2,Float32}[[-5.983643, -2.7967367], [-5.30451, -3.7396135], [-7.352544, -2.094505], [1.1971309, -1.1973175], [-4.5067463, -2.7967367], [-4.557674, -3.3363], [-1.9603726, -4.357616], [-3.6919067, -3.9336734], [-7.180439, -3.6060815], [-6.228844, -3.8548758], [-7.6897135, -2.854547], [0.33136383, -2.0259323], [-2.3677924, -1.1780473], [-1.2473879, -1.8525013], [-8.150008, -1.9687644], [-0.4325483, -1.7754208], [-5.485752, -1.8639804], [-3.4881968, -2.9701679], [-6.4282103, -1.8115884], [-6.3557134, -1.0781006], [-4.7789087, -2.304073], [-2.1386187, -3.008708], [-0.8145044, -3.6638918], [-1.5274891, -3.4326506], [0.66239244, -4.338346], [-6.5369554, -4.5569286], [0.6369287, -3.2977598], [0.8151749, -2.4113345], [-4.048399, -1.64053], [-1.9603726, -2.2571735], [0.051262714, -3.7024322], [-0.66172194, -2.8738172]]

    ss = double_col_width / 2

    ma = MolAut(5, 73; reduced=false)
    faa = plotgm(ma;
        layout=pp1,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        figure=(;
            # size=(200, 200),
            size=(single_col_width * 0.95, single_col_width * 0.4),
            fig_kwargs2...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    faa.axis.title = L"N=5"

    save("./data/figures/gv_sample_networks/r73_L5.pdf", faa.figure)

    faa
end

################################################################################
# Extras
################################################################################
function f2_r240_v1(; kwargs...)
    ma = MolAut(6, 240; reduced=false)

    pos = get_gv_layout_positions(ma;
        cluster=true
    )

    faa = plotgm(ma;
        layout=pos,
        flabels=false,
        get_ac_coloring_extra_kwargs(ma.mg)...,
        # nlabels=["000000"; fill("", 62); "111111"],
        # nlabels_align=(:center, :top),
        # nlabels_offset=Point2f(0.0, -0.05),
        # figure=(; size=(600, 600)),
        figure=(;
            size=(200, 130),
            fig_kwargs...
        ),
        other_kwargs...,
        kwargs...
    )

    hidedecorations!(faa.axis)
    # hidespines!(faa.axis)

    # faa.axis.title = "Rule 240"

    save("./data/figures/fig2/r240_final.pdf", faa.figure)

    faa
end
